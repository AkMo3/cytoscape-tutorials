<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>WikiPathways App</title>

		<link rel="stylesheet" href="../../css/reveal.css">
		<link rel="stylesheet" href="../../css/theme/cytoscape-protocol-1.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../../lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../../css/print/pdf.css' : '../../css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

<!-- ========================================================== -->
<!-- THIS IS WHERE YOUR CONTENT BEGINS -->

<section id='title'>
    <h1>clusterMaker App</h1>
    <p><a href="https://www.wikipathways.org" target="_blank">clusterMaker</a> is an app that provides the functionalities needed for clustering, dimensionality reduction and ranking. The clusterMaker app for Cytoscape is available from the <a href="https://apps.cytoscape.org/apps/clustermaker2" target="_blank">App Store</a>.</p>
     <br />
    <p>This tutorial will demonstrate how the various algorithms can be used together to explore a data set and how to integrate it with other Cytoscape apps and capabilities.
    <br />
    This workflow uses two types of data; protein-protein interaction data from the STRING database, and expression data from a yeast heat shock experiment. We will combine these two data types in Cytoscape.</p>
    <br />
<div class="footer" style="bottom: -3em;">
    <a href="https://github.com/cytoscape/cytoscape-tutorials/wiki"><img class="plain" src="../../assets/images/cytoscape-tutorials.png" style="height:70px;opacity:0.5"></a></div>

</section>

<section id='setup'>
        <h1>Setup</h1>
        <ul>
            <li>Install and launch the latest version of <a href="http://www.cytoscape.org/">Cytoscape</a>.</li>
            <li>Install the <b>clusterMaker 2 app</b> via <highlight>Apps &rarr; App Manager</highlight> or directly from the <a href="https://apps.cytoscape.org/apps/clustermaker2" target="_blank">App Store</a>.</li>
            <li>Install the <b>stringApp</b> via <highlight>Apps &rarr; App Manager</highlight> or directly from the <a href="http://apps.cytoscape.org/apps/stringApp" target="_blank">App Store</a>.</li>
            <li>Install the <a href="https://apps.cytoscape.org/apps/largestsubnetwork" target="_blank">Largest Subnetwork App</a> from the Cytoscape App Store, or using the <highlight>Cytoscape App Manager</highlight>.</li>
            <li>Download the <a href="https://cytoscape.github.io/cytoscape-tutorials/protocols/data/GPL51filt.txt">matrix data</a> for the yeast heat shock experiment.</li>
	</ul>

         <aside class="notes" data-markdown>
         Notes go here
         </aside>
</section>

<section id='import network 1'>
         <h1>Importing the PPI network</h1>
         <ul>
             <li>Launch Cytoscape, and go to <highlight>Import &rarr; Network from Public Databases...</highlight>.</li>
             <li>Select <b>STRING: protein query</b> in the <highlight>Data source</highlight> menu, and select <b>Saccharomyces cerevisiae</b> from the <b>Species</b> list. </li>
             <li>Select <highlight>All proteins of this species</highlight>.</li>
             <li>Select the option for <highlight>physical subnetwork</highlight> and set the <highlight>Confidence (score) cutoff</highlight> to <b>0.50</b>.</li>
             <li>Click <highlight>Import</highlight> to load. The network might take some time to load as it is large.</li> 
             <li>Finally, lets continue our analysis with only the largest connected subnetwork by clicking <highlight>Select &rarr; Nodes &rarr; Largest subnetwork</highlight>. Next, select <highlight>File &rarr; New Network &rarr; From Selected Nodes, All Edges</highlight>.</li>
         </ul>
         <img src="ImportDataString.png" style="width:45%">
         <aside class="notes" data-markdown>
         Notes go here
         </aside>
</section>
                
<section id='import network 2'>
        <h1>Importing the PPI network</h1>
        <p>The network should look like similar to this: </p>
             <img src="YeastStringNetwork.png" style="width:50%">
</section>
            

<section id='import data'>
    <h1>Importing the Expression Data</h1>
    <ul>
         <li>Select <highlight>File &rarr; Import &rarr; Table from File</highlight> and select the text file with the matrix data.</li>
         <li>Set the <highlight>Key column for the network</highlight> to <b>display name</b>.</li>
         <li>In the <highlight>Preview</highlight>, click on the <b>Gene symbol</b> column header and then click the key symbol, to assign this column as the key column for the data.</li>
         <li>Under <highlight>Advanced Options</highlight>, set the delimiter to <b>Tab</b> and turn off <b>COMMA</b>.</li>
         <li>Click <highlight>OK</highlight> to import.</li>
        </ul>
    <p>Now we have a protein-protein interaction network where each of the proteins are annotated with the 5 minute (GPL51-01), 10 minute (GPL51-02), 15 minute (GPL51-03), 20 minute (repeat) (GPL51-05), 40 minute (GPL51-06), 60 minute (GPL51-07), and 80 minute (GPL51-08) heat shock expression fold changes.</p>
         <aside class="notes" data-markdown>
         Notes go here
         </aside>
</section>

<section id='cluster leiden 1'>
    <h1>Clustering the PPI Network</h1>
         <p>Our network is too dense for easy interpretation, so the next step is to break the network up into clusters representing tightly connected groups of proteins such as complexes. We will use <a href="https://www.nature.com/articles/s41598-019-41695-z" target="_blank">Leiden clustering</a> to do this.</p>
        <ul>
            <li>Select <highlight>Apps &rarr; clusterMaker Cluster Network &rarr; Leiden Clusterer (remote)</highlight> to bring up the Leiden cluster options.</li>
            <li>Set the <highlight>Resolution parameter</highlight> to <b>0.5</b> and <highlight>Number of iterations</highlight> to <b>30</b>.</li>
            <li>In the <highlight>Source for array data</highlight> section, select <b>stringdb::score</b> as the <highlight>Attribute</highlight>. This is the edge confidence score assigned by STRING.</li>
            <li>Select <highlight>Create new clustered network</highlight> and click <highlight>OK</highlight>.</li>
    </ul>
         
         <aside class="notes" data-markdown>
         Notes go here
         </aside>
         </section>

<section id='cluster leiden 2'>
    <h1>Clustering the PPI Network</h1>
         <p>The resulting network should look similar to this. Note that we have disabled the <highlight>Glass ball effect</highlight> and <highlight>STRING style labels</highlight> in the STRING results panel at the right.</p>
         <img src="LeidenCluster.png" style="width:39%">
         <aside class="notes" data-markdown>
         Notes go here
         </aside>
</section>
                
<section id='cluster leiden 3'>
    <h1>Exploring Leiden Clusters</h1>
    <p>We can explore some of the clusters to confirm that Leiden has done a reasonable job. To do this, we will run functional enrichment analysis on the individual clusters.</p>
    <ul>
        <li>Select the first cluster (top left) by click and drag, then select <highlight>Functional enrichment</highlight> in the STRING results panel at the right.</li>
        <li>Select <b>genome</b> for <highlight>Network to be used as background</highlight> and click <highlight>OK</highlight> to continue.</li>
        <li>The results will open in the <highlight>STRING Enrichment</highlight> table, sorted by FDR value. In the case of cluster 1, it is clear from the description of enriched terms that the cluster represents the proteins in the ribosome.</li>
        <li>Repeat the process with the next 3 clusters.</li>
    <p>You will notice that the top 4 clusters represent the ribosome, preribosome, large subunit of the preribosome, and the mitochondrial ribosome, respectively. Based on this, we can assume that Leiden clustering worked reasonably well.</p>
    </ul>
                
                
</section>

<section id='cluster hierarchical 1'>
    <h1>Hierarchical Clustering of Expression Data</h1>
         <p>A classical analysis of an expression data set would involve performing a hierarchical clustering of the data and viewing it using a heatmap with associated dendrogram. We can do this using clusterMaker2 using the <highlight>Cluster Attributes</highlight> feature.</p>
        <ul>
            <li>Select <highlight>Apps→clusterMaker Cluster Attributes &rarr; Hierarchical cluster</highlight>.</li>
            <li>Select all of the heat shock columns (5 min, 10 min, 15 min, 20 min repeat, 40 min, 60 min, and 80 min).</li>
            <li>Select <highlight>Show TreeView when complete</highlight> and click <highlight>OK</highlight>.</li>
        </ul>
         
         <aside class="notes" data-markdown>
         Notes go here
         </aside>
</section>

<section id='cluster hierarchical 2'>
         <h1>Hierarchical Clustering of Expression Data</h1>
         <p>This will bring up a heat map with the associated dendrogram for the data set. By selecting branches of the dendrogram, we can select groups of genes in the heatmap and simultaneously select the corresponding proteins in the PPI view.</p>
         <p>By selecting branches of the dendrogram, we can select groups of genes in the heatmap and simultaneously select the corresponding proteins in the PPI view.</p>
         <img src="Treeview.png" style="width:30%">
         <aside class="notes" data-markdown>
         Notes go here
         </aside>
</section>

<section id='coloring 1'>
    <h1>Coloring the PPI Network</h1>
    <p>To help understand the biological significance of these transcriptional changes at the protein level, we would like to find a mapping from our hierarchical clustering onto the proteins in our PPI network. This could be useful, for example, to see if any particular complexes are particularly affected by transcriptional changes. There are two ways of doing this:</p>
    <ul>
        <li>In TreeView, select <highlight>Map Colors Onto Network...</highlight>.</li>
        <li>Select all attributes in the <highlight>Attribute List</highlight>, making sure they are in the correct order, and click <highlight>Create HeatStrips</highlight>.</li>
    </ul>
    <p>This will add bar charts showing the expression fold changes at the various timepoints on the nodes. Unfortunately, this is extremely hard to see when looking at the entire network.</p>
    <img src="HeatStrips.png" style="width:40%">
</section>
                
<section id='coloring 2'>
    <h1>Coloring the PPI Network</h1>
    <p>The second way to color the network is to use the information from the hierarchical clustering to create a new attribute, and then use this for coloring. We will use the ability to select branches of the dendrogram to select the corresponding nodes in the network.</p>
    <ul>
        <li>In TreeView, ......</li>
        <li>...</li>
    </ul>
    
    <img src="ColorFinal.png" style="width:45%">
</section>

                
<section id='umap 1'>
    <h1>UMAP analysis of Expression Data</h1>
    <p>We will now look at the same heat shock expression data used for the hierarchical cluster, but this time using the <a href="https://doi.org/10.48550/arXiv.1802.03426" target="_blank">Uniform Manifold Approximation and Projection (UMAP)</a> approach to explore a 2D embedding of this multidimensional data.</p>
    <ul>
        <li>Select all nodes with a color value or a “Non-Zero Count” 1 or greater (you can sort the column or use the Cytoscape Filter tab).</li>
        <li>Select <highlight>Apps &rarr; clusterMaker Dimensionality Reduction &rarr; UMAP (remote)</highlight>.</li>
        <li>Select all six of the heat shock columns, select <highlight>Only use data from selected nodes</highlight> and set the <highlight>Number of neighbors</highlight> to <b>20</b> and the <highlight>Minimum distance</highlight> to <b>0.5</b>.</li>
        <li>Select <highlight>Show scatter plot with results</highlight> and click <highlight>OK</highlight>.</li>
        <li>Once the UMAP scatter plot comes up, click on <highlight>Get Colors</highlight> to apply the red-blue coloring from the nodes to the UMAP.</li>
    </ul>
</section>

<section id='umap 2'>
    <h1>UMAP analysis of Expression Data</h1>
    <p>...</p>
</section>
                
<section id='fuzzy cluster 1'>
    <h1>Fuzzy Clustering</h1>
    <p>....</p>
    
</section>
                
<section id='fuzzy cluster 2'>
    <h1>Fuzzy Clustering</h1>
    <p>....</p>
    
</section>
                
<section id='cluster ranking 1'>
    <h1>Cluster Ranking</h1>
    <p>...</p>
    
</section>
                
<section id='cluster ranking 2'>
    <h1>Cluster Ranking</h1>
    <p>...</p>
    
</section>
                
<section id='summary'>
    <h1>Summary</h1>
    <p>...</p>
    
</section>


<!-- THIS IS WHERE YOUR CONTENT ENDS -->
<!-- ========================================================== -->

			</div>
		</div>

		<script src="../../lib/js/head.min.js"></script>
		<script src="../../js/reveal.js"></script>

<script>
	Reveal.addEventListener( 'ready', function() {
	if(!window.navigator.userAgent.includes('CyBrowser')){
		var divs = document.getElementsByClassName("cybrowser")
		for (var i=0;i<divs.length;i++){
			divs[i].style.display = "none";
		}
	} else {
		var divs = document.getElementsByClassName("not-cybrowser")
		for (var i=0;i<divs.length;i++){
			divs[i].style.display = "none";
		}
	}
});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-155159-15', 'auto');
  ga('send', 'pageview');

</script>
		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,
				controls: true,
				progress: true,
				slideNumber: false,
				touch: true,
				fragments: true,
				help: true,
				showNotes: false,
				previewLinks: false,
				transition: 'slide', // none/fade/slide/convex/concave/zoom
				width: 1200,
				height: 860,
				autoSlide: 0,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
				{ src: '../../plugin/markdown/marked.js' },
				{ src: '../../plugin/markdown/markdown.js' },

				{ src: '../../plugin/zoom-js/zoom.js', async: true, condition: function(){ return !!document.body.classList; } },
				{ src: '../../plugin/notes/notes.js', async: true },
				{ src: '../../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
				{ src: '../../plugin/external/external.js', condition: function() { return !!document.querySelector( '[data-external]' ); } }
				]
				});
			</script>
		</body>
	</html>
